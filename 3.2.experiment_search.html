
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>3.2. Search Experiment &#8212; AI Workshop</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = '3.2.experiment_search';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="0.intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="AI Workshop - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="AI Workshop - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="0.intro.html">
                    Welcome
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">1. Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="1.setup.html">Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="1.rag-intro.html">RAG - Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="1.context.html">Context</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">2. Implementation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="2.rag-implementation.html">RAG - Baseline implementation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">3. Experimentation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="3.0.experiments.html">Experiments</a></li>
<li class="toctree-l1"><a class="reference internal" href="3.1.experiment_embedding.html">3.1. Embeddings Experiment</a></li>
<li class="toctree-l1"><a class="reference internal" href="3.2.experiment_chunking.html">3.2. Chunking Experiment</a></li>
<li class="toctree-l1"><a class="reference internal" href="3.3.end_to_end_evaluation.html">3.3. End-to-end evaluation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">4. Production</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="4.post-production.html">Post-production</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="5.1.generation-qa.html">Generation of synthetic data</a></li>



</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2F3.2.experiment_search.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/3.2.experiment_search.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>3.2. Search Experiment</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-role-of-search">The Role of Search</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#perform-a-keyword-search">1. Perform a keyword search</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#perform-a-vector-search">2. Perform a vector search</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#perform-a-hybrid-search">3. Perform a hybrid search</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#perform-a-semantic-hybrid-search-required-semantic-ranker-enabled">4. Perform a semantic hybrid search - Required Semantic Ranker enabled</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusions">💡 Conclusions</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="search-experiment">
<h1>3.2. Search Experiment<a class="headerlink" href="#search-experiment" title="Link to this heading">#</a></h1>
<p>Search is at the core of the RAG pattern. Precise, efficient, and consistent search is critical when implementing a solution based on RAG.</p>
<p>There are four types of search <a class="reference external" href="https://learn.microsoft.com/en-us/azure/ai-services/openai/concepts/use-your-data?tabs=ai-search#search-options">options</a>: keyword search, semantic search, vector search, hybrid search.</p>
<section id="the-role-of-search">
<h2><a class="reference external" href="https://github.com/microsoft/rag-openai/blob/main/topics/RAG_EnablingSearch.md#the-role-of-search">The Role of Search</a><a class="headerlink" href="#the-role-of-search" title="Link to this heading">#</a></h2>
<p>The main purpose of the search tool is to bring the first cut of relevant documents for further analysis by the large language model - it is there to filter the noise and reduce the result set for the model to summarize.</p>
<p>Search is at the heart of a RAG solution - it is the mechanism that ensures that the context that is sent to the prompt contains relevant information for it to answer the question.</p>
<!-- ### [Evaluating the Retrieval Component](https://github.com/microsoft/rag-openai/blob/main/topics/RAG_EnablingEvaluation.md#evaluating-the-retrieval-component)

Regarding the Retrieval component, the dataset is composed of question and citation instead of question and answer.

- question: the user question
- citation: the piece(s) of text that contains the relevant content to answer the user question
- answer: the final answer in a human readable/friendly format
  Evaluating the Retrieval component means to evaluate if for a given query (user question) the search engine is returning the relevant citation(s). -->
<p>📝<strong>Hypothesis</strong></p>
<p>The hypothesis for this experiment is an exploratory one: “Can introducing a new type of search improve the system’s performance?”</p>
<p>🎯 <strong>Measure of Success</strong></p>
<p>Retrieval information is a well-known problem and the classic metrics are: Precision, Recall, F1 Score, Mean Average Precision (MAP), Mean Normalized Discounted Cumulative Gain (Mean NDCG) and Mean Reciprocal Rank (MRR). More details can be found at Evaluating Information Retrieval Models: A Comprehensive Guide to Performance Metrics.</p>
<p><a class="reference external" href="https://github.com/microsoft/rag-openai/blob/main/topics/RAG_EnablingEvaluation.md#evaluation-metrics">Evaluation Metrics</a>
Linnk: <a class="reference external" href="https://medium.com/&#64;prateekgaurav/evaluating-information-retrieval-models-a-comprehensive-guide-to-performance-metrics-78aadacb73b4#:~:text=Evaluating%20Information%20Retrieval%20Models%3A%20A%20Comprehensive%20Guide%20to,...%206%206.%20Mean%20Reciprocal%20Rank%20%28MRR%29%20">https://medium.com/&#64;prateekgaurav/evaluating-information-retrieval-models-a-comprehensive-guide-to-performance-metrics-78aadacb73b4#:~:text=Evaluating Information Retrieval Models%3A A Comprehensive Guide to,… 6 6. Mean Reciprocal Rank (MRR) </a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span> --no-display
<span class="o">%</span><span class="n">run</span> <span class="o">-</span><span class="n">i</span> <span class="o">./</span><span class="n">pre</span><span class="o">-</span><span class="n">requisites</span><span class="o">.</span><span class="n">ipynb</span>
<span class="o">%</span><span class="n">run</span> <span class="o">-</span><span class="n">i</span> <span class="o">./</span><span class="n">helpers</span><span class="o">/</span><span class="n">search</span><span class="o">.</span><span class="n">ipynb</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">azure.search.documents.models</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">VectorizedQuery</span><span class="p">,</span>
    <span class="n">QueryType</span><span class="p">,</span>
    <span class="n">QueryCaptionType</span><span class="p">,</span>
    <span class="n">QueryAnswerType</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">azure.search.documents</span> <span class="kn">import</span> <span class="n">SearchClient</span>

<span class="n">search_index_name</span> <span class="o">=</span> <span class="s2">&quot;index_chunks_2&quot;</span>
<span class="n">search_client</span> <span class="o">=</span> <span class="n">SearchClient</span><span class="p">(</span>
    <span class="n">endpoint</span><span class="o">=</span><span class="n">service_endpoint</span><span class="p">,</span> <span class="n">index_name</span><span class="o">=</span><span class="n">search_index_name</span><span class="p">,</span> <span class="n">credential</span><span class="o">=</span><span class="n">credential</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="perform-a-keyword-search">
<h2>1. Perform a keyword search<a class="headerlink" href="#perform-a-keyword-search" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;How can I test my solution&quot;</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">search_client</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
    <span class="n">search_text</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
    <span class="n">select</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;chunkId&quot;</span><span class="p">,</span> <span class="s2">&quot;chunkContent&quot;</span><span class="p">,</span> <span class="s2">&quot;source&quot;</span><span class="p">],</span>
    <span class="n">top</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>

<span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;chunkId: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;chunkId&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;source: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Score: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;@search.score&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;chunkContent: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;chunkContent&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ResourceNotFoundError</span><span class="g g-Whitespace">                     </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">line</span> <span class="mi">9</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;How can I test my solution&quot;</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">results</span> <span class="o">=</span> <span class="n">search_client</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span>     <span class="n">search_text</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span>     <span class="n">select</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;chunkId&quot;</span><span class="p">,</span> <span class="s2">&quot;chunkContent&quot;</span><span class="p">,</span> <span class="s2">&quot;source&quot;</span><span class="p">],</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span>     <span class="n">top</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="p">)</span>
<span class="ne">----&gt; </span><span class="mi">9</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span>     <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;chunkId: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;chunkId&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span>     <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;source: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nn">File ~/handsontest/ai-hands-on-lab/.venv/lib/python3.9/site-packages/azure/search/documents/_paging.py:54,</span> in <span class="ni">SearchItemPaged.__next__</span><span class="nt">(self)</span>
<span class="g g-Whitespace">     </span><span class="mi">52</span>     <span class="n">first_iterator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_first_iterator_instance</span><span class="p">()</span>
<span class="g g-Whitespace">     </span><span class="mi">53</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_page_iterator</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">first_iterator</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">54</span> <span class="k">return</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_page_iterator</span><span class="p">)</span>

<span class="nn">File ~/handsontest/ai-hands-on-lab/.venv/lib/python3.9/site-packages/azure/core/paging.py:75,</span> in <span class="ni">PageIterator.__next__</span><span class="nt">(self)</span>
<span class="g g-Whitespace">     </span><span class="mi">73</span>     <span class="k">raise</span> <span class="ne">StopIteration</span><span class="p">(</span><span class="s2">&quot;End of paging&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">74</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">75</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">continuation_token</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">76</span> <span class="k">except</span> <span class="n">AzureError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">77</span>     <span class="k">if</span> <span class="ow">not</span> <span class="n">error</span><span class="o">.</span><span class="n">continuation_token</span><span class="p">:</span>

<span class="nn">File ~/handsontest/ai-hands-on-lab/.venv/lib/python3.9/site-packages/azure/search/documents/_paging.py:124,</span> in <span class="ni">SearchPageIterator._get_next_cb</span><span class="nt">(self, continuation_token)</span>
<span class="g g-Whitespace">    </span><span class="mi">122</span> <span class="k">def</span> <span class="nf">_get_next_cb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">continuation_token</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">123</span>     <span class="k">if</span> <span class="n">continuation_token</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">124</span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">documents</span><span class="o">.</span><span class="n">search_post</span><span class="p">(</span><span class="n">search_request</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_initial_query</span><span class="o">.</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">126</span>     <span class="n">_next_link</span><span class="p">,</span> <span class="n">next_page_request</span> <span class="o">=</span> <span class="n">unpack_continuation_token</span><span class="p">(</span><span class="n">continuation_token</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">128</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">documents</span><span class="o">.</span><span class="n">search_post</span><span class="p">(</span><span class="n">search_request</span><span class="o">=</span><span class="n">next_page_request</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_kwargs</span><span class="p">)</span>

<span class="nn">File ~/handsontest/ai-hands-on-lab/.venv/lib/python3.9/site-packages/azure/core/tracing/decorator.py:78,</span> in <span class="ni">distributed_trace.&lt;locals&gt;.decorator.&lt;locals&gt;.wrapper_use_tracer</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">76</span> <span class="n">span_impl_type</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">tracing_implementation</span><span class="p">()</span>
<span class="g g-Whitespace">     </span><span class="mi">77</span> <span class="k">if</span> <span class="n">span_impl_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">78</span>     <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">80</span> <span class="c1"># Merge span is parameter is set, but only if no explicit parent are passed</span>
<span class="g g-Whitespace">     </span><span class="mi">81</span> <span class="k">if</span> <span class="n">merge_span</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">passed_in_parent</span><span class="p">:</span>

<span class="nn">File ~/handsontest/ai-hands-on-lab/.venv/lib/python3.9/site-packages/azure/search/documents/_generated/operations/_documents_operations.py:754,</span> in <span class="ni">DocumentsOperations.search_post</span><span class="nt">(self, search_request, request_options, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">751</span> <span class="n">response</span> <span class="o">=</span> <span class="n">pipeline_response</span><span class="o">.</span><span class="n">http_response</span>
<span class="g g-Whitespace">    </span><span class="mi">753</span> <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">200</span><span class="p">]:</span>
<span class="ne">--&gt; </span><span class="mi">754</span>     <span class="n">map_error</span><span class="p">(</span><span class="n">status_code</span><span class="o">=</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">,</span> <span class="n">error_map</span><span class="o">=</span><span class="n">error_map</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">755</span>     <span class="n">error</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_deserialize</span><span class="o">.</span><span class="n">failsafe_deserialize</span><span class="p">(</span><span class="n">_models</span><span class="o">.</span><span class="n">SearchError</span><span class="p">,</span> <span class="n">pipeline_response</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">756</span>     <span class="k">raise</span> <span class="n">HttpResponseError</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">error</span><span class="p">)</span>

<span class="nn">File ~/handsontest/ai-hands-on-lab/.venv/lib/python3.9/site-packages/azure/core/exceptions.py:164,</span> in <span class="ni">map_error</span><span class="nt">(status_code, response, error_map)</span>
<span class="g g-Whitespace">    </span><span class="mi">162</span>     <span class="k">return</span>
<span class="g g-Whitespace">    </span><span class="mi">163</span> <span class="n">error</span> <span class="o">=</span> <span class="n">error_type</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">164</span> <span class="k">raise</span> <span class="n">error</span>

<span class="ne">ResourceNotFoundError</span>: () The index &#39;index_chunks_2&#39; for service &#39;aisearch-workshop-xz27sepwdcenq&#39; was not found.
<span class="ne">Code</span>: 
<span class="ne">Message</span>: The index &#39;index_chunks_2&#39; for service &#39;aisearch-workshop-xz27sepwdcenq&#39; was not found.
</pre></div>
</div>
</div>
</div>
</section>
<section id="perform-a-vector-search">
<h2>2. Perform a vector search<a class="headerlink" href="#perform-a-vector-search" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;tools for software development&quot;</span>

<span class="n">query_embeddings</span> <span class="o">=</span> <span class="n">get_query_embedding</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<span class="n">vector_query</span> <span class="o">=</span> <span class="n">VectorizedQuery</span><span class="p">(</span>
    <span class="n">vector</span><span class="o">=</span><span class="n">query_embeddings</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">k_nearest_neighbors</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="s2">&quot;chunkContentVector&quot;</span>
<span class="p">)</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">search_client</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
    <span class="n">search_text</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">vector_queries</span><span class="o">=</span><span class="p">[</span><span class="n">vector_query</span><span class="p">],</span>
    <span class="n">select</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;chunkId&quot;</span><span class="p">,</span> <span class="s2">&quot;chunkContent&quot;</span><span class="p">,</span> <span class="s2">&quot;source&quot;</span><span class="p">],</span>
    <span class="n">top</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>

<span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;chunkId: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;chunkId&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;source: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Score: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;@search.score&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;chunkContent: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;chunkContent&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>chunkId: chunk178_4
source: ..\data\docs\code-with-engineering\agile-development\advanced-topics\team-agreements\team-manifesto.md
Score: 0.85869
chunkContent: Tools

Generally team sessions are enough for building a manifesto and having a consensus around it, and if there is a need for improving it in a structured way, there are many blogs and tools online, any retrospective tool can be used.

Resources

Technical Agility*
</pre></div>
</div>
</div>
</div>
<section id="perform-a-hybrid-search">
<h3>3. Perform a hybrid search<a class="headerlink" href="#perform-a-hybrid-search" title="Link to this heading">#</a></h3>
<p>Hybrid Retrieval brings out the best of Keyword and Vector Search</p>
<p>Keyword and vector retrieval tackle search from different perspectives, which yield complementary capabilities. Vector retrieval semantically matches queries to passages with similar meanings. This is powerful because embeddings are less sensitive to misspellings, synonyms, and phrasing differences and can even work in cross lingual scenarios. Keyword search is useful because it prioritizes matching specific, important words that might be diluted in an embedding.</p>
<p>User search can take many forms. Hybrid retrieval consistently brings out the best from both retrieval methods across query types. With the most effective L1, the L2 ranking step can significantly improve the quality of results in the top positions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;scalable storage solution&quot;</span>
<span class="n">query_embeddings</span> <span class="o">=</span> <span class="n">query_embeddings</span> <span class="o">=</span> <span class="n">get_query_embedding</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<span class="n">vector_query</span> <span class="o">=</span> <span class="n">VectorizedQuery</span><span class="p">(</span>
    <span class="n">vector</span><span class="o">=</span><span class="n">query_embeddings</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">k_nearest_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="s2">&quot;chunkContentVector&quot;</span>
<span class="p">)</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">search_client</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
    <span class="n">search_text</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
    <span class="n">vector_queries</span><span class="o">=</span><span class="p">[</span><span class="n">vector_query</span><span class="p">],</span>
    <span class="n">select</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;chunkId&quot;</span><span class="p">,</span> <span class="s2">&quot;chunkContent&quot;</span><span class="p">,</span> <span class="s2">&quot;source&quot;</span><span class="p">],</span>
    <span class="n">top</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>

<span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;chunkId: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;chunkId&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;source: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Score: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;@search.score&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;chunkContent: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;chunkContent&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>chunkId: chunk80_12
source: ..\data\docs\code-with-dataops\industry-solutions\dataops-for-automotive\dataops-avops-platform.md
Score: 0.030751174315810204
chunkContent: Similarly, there are rules set up in the ADLS blob storage for moving the data from &quot;Hot&quot; to &quot;Cold&quot; tier as data travels to &quot;DERIVED&quot; from &quot;RAW&quot; Zone.

Solution also provides flexibility in terms of configurations for data lifecycle to meet the customer needs.

Cosmos DB stores the structured data of this solution, that is the foundational units of this solution viz. Measurement and Datastream json files.

The lineage information for Datastream is finally stored in the Cosmos DB. An API (Metadata API) is exposed over Cosmos DB to query the structured data and that also helps in tracking the data lineage.

Cosmos DB serves multiple purposes for the AVOps platform. Not only does it store the structured metadata of Rosbag files, but it also allows multiple clients to work with the system through a storage layer manager (Metadata API).

Key requirement with lineage tracking was to be able to reach to specific measurement/Rosbag file from processed data (or a Datastream). Decision of keeping lineage in Cosmos DB with Mongo graph query made it easy and simple to kick-start traceability support. Although, Purview could be the first choice for tracking the data lineage, it could have made the solution little more expensive, bulkier and involved some headache of writing custom APIs on top of cosmos for lineage (to integrate with it).

Compute
chunkId: chunk9_7
source: ..\data\docs\code-with-dataops\capabilities\analytical-systems\common-capabilities\storage\index.md
Score: 0.029462365433573723
chunkContent: Data sets possess distinct lifecycle, with early stages characterized by frequent access to certain data. However, as the data ages, the need for access decreases dramatically. Some data remains unused in the cloud, with infrequent access once stored, while others may expire days or months after creation. Some data sets are actively read and modified throughout their lifecycle. Data can be transitioned to different access tiers or expired using Azure Storage Lifecycle Management&#39;s rule-based policies.

Azure storage offers different access tiers namely hot, cool and archive. By default when data is created, it&#39;s stored under hot tier. The data then can be moved or deleted based on Storage Lifecycle Management rules, including an option to move it to cool or archive tiers.

An important consideration when using storage tiers is the rehydration process from the archive tier. Reading data from archive tier requires data rehydration first. The rehydration process may be time-consuming and expensive. For more information, see overview of blob rehydration from the archive tier.

A sample implementation can be found in MDW repo: Storage (Single). These Terraform based IaC templates demonstrate Azure storage accounts/containers creation and data lifecycle rule configuration at scale.

See Lifecycle management overview for more information.

Storage on Microsoft Fabric
chunkId: chunk154_1
source: ..\data\docs\code-with-engineering\design\sustainability\sustainable-action-disclaimers.md
Score: 0.025402450934052467
chunkContent: Running an edge device negates many of the benefits of hyperscale compute facilities, so considering the local energy grid mix and the typical timing of the workloads is important to determine if this is beneficial overall.  The larger volume of data that needs to be transmitted, the more this solution becomes appealing. For example, sending large amounts of audio and video content for processing.

ACTION: Consider physically shipping data to the provider

Shipping physical items has its own carbon impact, depending on the mode of transportation, which needs to be understood before making this decision.  The larger the volume of data that needs to be transmitted the more this options may be beneficial.

ACTION: Consider the energy efficiency of languages

When selecting a programming language, the most energy efficient programming language may not always be the best choice for development speed, maintenance, integration with dependent systems, and other project factors. But when deciding between languages that all meet the project needs, energy efficiency can be a helpful consideration.

ACTION: Use caching policies

A cache provides temporary storage of resources that have been requested by an application. Caching can improve application performance by reducing the time required to get a requested resource. Caching can also improve sustainability by decreasing the amount of network traffic.
</pre></div>
</div>
</div>
</div>
</section>
<section id="perform-a-semantic-hybrid-search-required-semantic-ranker-enabled">
<h3>4. Perform a semantic hybrid search - Required Semantic Ranker enabled<a class="headerlink" href="#perform-a-semantic-hybrid-search-required-semantic-ranker-enabled" title="Link to this heading">#</a></h3>
<p>For this, we would first need to update our index and add semantic configuration</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">azure.search.documents.indexes</span> <span class="kn">import</span> <span class="n">SearchIndexClient</span>
<span class="kn">from</span> <span class="nn">azure.search.documents.indexes.models</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">SemanticConfiguration</span><span class="p">,</span>
    <span class="n">SemanticSearch</span><span class="p">,</span>
    <span class="n">SemanticField</span><span class="p">,</span>
    <span class="n">SemanticPrioritizedFields</span><span class="p">,</span>
<span class="p">)</span>


<span class="k">def</span> <span class="nf">create_index</span><span class="p">(</span><span class="n">search_index_name</span><span class="p">):</span>

    <span class="n">client</span> <span class="o">=</span> <span class="n">SearchIndexClient</span><span class="p">(</span><span class="n">service_endpoint</span><span class="p">,</span> <span class="n">credential</span><span class="p">)</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_index</span><span class="p">(</span><span class="n">search_index_name</span><span class="p">)</span>

    <span class="c1"># 2. Define the semantic Settings</span>
    <span class="c1"># Note: It requires semantic ranker enabled on your search service</span>
    <span class="c1"># https://learn.microsoft.com/en-us/azure/search/semantic-search-overview</span>
    <span class="c1"># https://learn.microsoft.com/en-us/azure/search/semantic-how-to-query-request?tabs=portal%2Cportal-query</span>
    <span class="c1"># https://learn.microsoft.com/en-us/azure/search/semantic-how-to-query-request?tabs=sdk%2Cportal-query</span>
    <span class="n">semantic_config</span> <span class="o">=</span> <span class="n">SemanticConfiguration</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;my-semantic-config&quot;</span><span class="p">,</span>
        <span class="n">prioritized_fields</span><span class="o">=</span><span class="n">SemanticPrioritizedFields</span><span class="p">(</span>
            <span class="c1"># title_field=SemanticField(field_name=&quot;title&quot;),</span>
            <span class="c1"># keywords_fields=[SemanticField(field_name=&quot;category&quot;)],</span>
            <span class="n">content_fields</span><span class="o">=</span><span class="p">[</span><span class="n">SemanticField</span><span class="p">(</span><span class="n">field_name</span><span class="o">=</span><span class="s2">&quot;chunkContent&quot;</span><span class="p">)],</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">semantic_search</span> <span class="o">=</span> <span class="n">SemanticSearch</span><span class="p">(</span><span class="n">configurations</span><span class="o">=</span><span class="p">[</span><span class="n">semantic_config</span><span class="p">])</span>
    <span class="n">index</span><span class="o">.</span><span class="n">semantic_search</span> <span class="o">=</span> <span class="n">semantic_search</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">create_or_update_index</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> created or updated&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">create_index</span><span class="p">(</span><span class="n">search_index_name</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>index_chunks_2 created or updated
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;what is azure sarch?&quot;</span>

<span class="n">query_embeddings</span> <span class="o">=</span> <span class="n">get_query_embedding</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<span class="n">vector_query</span> <span class="o">=</span> <span class="n">VectorizedQuery</span><span class="p">(</span>
    <span class="n">vector</span><span class="o">=</span><span class="n">query_embeddings</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">k_nearest_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="s2">&quot;chunkContentVector&quot;</span>
<span class="p">)</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">search_client</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
    <span class="n">search_text</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
    <span class="n">vector_queries</span><span class="o">=</span><span class="p">[</span><span class="n">vector_query</span><span class="p">],</span>
    <span class="n">select</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;chunkId&quot;</span><span class="p">,</span> <span class="s2">&quot;chunkContent&quot;</span><span class="p">,</span> <span class="s2">&quot;source&quot;</span><span class="p">],</span>
    <span class="n">query_type</span><span class="o">=</span><span class="n">QueryType</span><span class="o">.</span><span class="n">SEMANTIC</span><span class="p">,</span>
    <span class="n">semantic_configuration_name</span><span class="o">=</span><span class="s2">&quot;my-semantic-config&quot;</span><span class="p">,</span>
    <span class="n">query_caption</span><span class="o">=</span><span class="n">QueryCaptionType</span><span class="o">.</span><span class="n">EXTRACTIVE</span><span class="p">,</span>
    <span class="n">query_answer</span><span class="o">=</span><span class="n">QueryAnswerType</span><span class="o">.</span><span class="n">EXTRACTIVE</span><span class="p">,</span>
    <span class="n">top</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">semantic_answers</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get_answers</span><span class="p">()</span>
<span class="k">for</span> <span class="n">answer</span> <span class="ow">in</span> <span class="n">semantic_answers</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">answer</span><span class="o">.</span><span class="n">highlights</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Semantic Answer: </span><span class="si">{</span><span class="n">answer</span><span class="o">.</span><span class="n">highlights</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Semantic Answer: </span><span class="si">{</span><span class="n">answer</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Semantic Answer Score: </span><span class="si">{</span><span class="n">answer</span><span class="o">.</span><span class="n">score</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;chunkId: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;chunkId&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;source: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Score: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;@search.score&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;chunkContent: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;chunkContent&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1"># print(f&quot;Title: {result[&#39;title&#39;]}&quot;)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Reranker Score: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;@search.reranker_score&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">captions</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;@search.captions&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">captions</span><span class="p">:</span>
        <span class="n">caption</span> <span class="o">=</span> <span class="n">captions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">caption</span><span class="o">.</span><span class="n">highlights</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Caption: </span><span class="si">{</span><span class="n">caption</span><span class="o">.</span><span class="n">highlights</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Caption: </span><span class="si">{</span><span class="n">caption</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>chunkId: chunk80_13
source: ..\data\docs\code-with-dataops\industry-solutions\dataops-for-automotive\dataops-avops-platform.md
Score: 0.020846012979745865
chunkContent: Azure Batch is the heart of compute in this solution. Azure Batch natively supports massively parallel processing, which fine-tunes the performance and turn-around time of data pipelines.

For a sample Rosbag extraction process, multiple topics (lidar, radar, camera1, camera2 etc.) need to be extracted. It is designed to extract all the topics in with multiple jobs running in parallel.

Azure Batch supports Azure spot VM instances, which reduces the cost of the Batch workloads. Setting up an auto-scale formula helps further in cost optimization.

Solution provides flexibility in terms of hosting the compute for the API/services exposed.

Azure Function can help optimize cost of burst kind of traffic scenarios, when services are idle for most of the time.

AKS (Azure Kubernetes Service) can be also in consideration when there is a requirement of multiple microservice&#39;s communication.

If it’s about the ease of usability, App service/ App service with containers can be used.

References

Microsoft&#39;s AVOps reference architecture

AVOps Solution Kit: AVOps solution kit is a Dataops platform which helps customers to kick-start quickly on high scale data ingestion requirements.
Reranker Score: 2.985140800476074
Caption: &lt;em&gt;Azure Batch&lt;/em&gt; is the heart of compute in this solution.&lt;em&gt; Azure Batch&lt;/em&gt; natively supports massively parallel processing, which fine-tunes the performance and turn-around time of data pipelines. For a sample Rosbag extraction process, multiple topics (lidar, radar, camera1, camera2 etc.) need to be extracted.

chunkId: chunk152_12
source: ..\data\docs\code-with-devsecops\Enterprise-Solutions\governance\secure-software-supply-chain-for-containerized-workloads.md
Score: 0.021601775661110878
chunkContent: This implementation delivers a notation-based secure software supply chain in Azure built on Azure Kubernetes Service (AKS) and Azure Container Registry (ACR).

Either Azure Pipelines or GitHub Actions can be used in the build phase to create the software release and security artifacts. Microsoft&#39;s sbom-tool is used to generate an SBOM from the source code, dependencies, and the container image packages. A vulnerability report is generated using Aquasec&#39;s Trivy tool (only supports Linux workloads). Notation is used to sign the container image and security artifacts with a signing cert stored in Azure Key Vault. The ORAS tool is used to bundle the signatures, security artifacts, and container image (software release), and then to publish the release bundle to Azure Container Registry.

Policy enforcement is enabled in the deploy phase by using Open Policy Agent&#39;s Gatekeeper and the Ratify verification tool. Ratify acts as an external data provider for Gatekeeper and facilitates exposing the appropriate information from the release bundle to the policy engine. Ratify verifies component signatures using a root CA certificate stored in its configuration.

The following policies are enforced:

All images must be signed to ensure workload integrity

All images must have an attached and signed SBOM and vulnerability scan result

All images may only be retrieved from allowed list of container registries
Reranker Score: 1.5704656839370728
Caption: This implementation delivers a notation-based secure software supply chain in Azure built on&lt;em&gt; Azure Kubernetes Service&lt;/em&gt; (AKS) and&lt;em&gt; Azure Container Registry&lt;/em&gt; (ACR). Either Azure Pipelines or GitHub Actions can be used in the build phase to create the software release and security artifacts.

chunkId: chunk150_3
source: ..\data\docs\code-with-devsecops\Enterprise-Solutions\Cloud-Native-Application-Bundle-(CNAB)-for-Azure-Trusted-Research-Environment-(TRE)\index.md
Score: 0.012048192322254181
chunkContent: Duffle - Originally while the CNAB specification was developed, Duffle (duffle.sh) was used as a reference implementation to assist other people when developing their own implementations. Now that the CNAB v1 spec has been stable for years, it is no longer needed and has been archived.

Porter is now the only open-source implementation of CNAB and is constantly being improved and maintained.

Porter is Microsoft recommended tool for customers to use. It is a part of the CNCF (cloud native computing foundation) and is maintained by multiple companies in addition to individual community members.

Case Studies

EY teams uses Porter to combine different Azure components infrastructure into a single application bundle. This reduces the complexity of dependency management and allows EY teams to reduce the operational overhead of managing its hundreds of applications.

Azure Trusted Research Environment (Azure TRE) - An OSS solution developed and maintained by CSE, which uses Porter to bundle deployment of Azure Resources and third-party solutions on Azure. We will see an example later on from this project.

Building a bundle

A Porter bundle is defined by a Porter manifest file named porter.yaml. The manifest defines metadata about the bundle, such as its name or what parameters it accepts. In addition, it also defines actions that the bundle can execute, like install, upgrade and uninstall along with custom actions.
Reranker Score: 1.2104779481887817
Caption: Azure Trusted Research Environment (Azure TRE) - An OSS solution developed and maintained by CSE, which uses Porter to bundle deployment of Azure Resources and third-party solutions on Azure. We will see an example later on from this project. Building a bundle  A Porter bundle is defined by a Porter manifest file named porter.yaml.
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="conclusions">
<h2>💡 Conclusions<a class="headerlink" href="#conclusions" title="Link to this heading">#</a></h2>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-role-of-search">The Role of Search</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#perform-a-keyword-search">1. Perform a keyword search</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#perform-a-vector-search">2. Perform a vector search</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#perform-a-hybrid-search">3. Perform a hybrid search</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#perform-a-semantic-hybrid-search-required-semantic-ranker-enabled">4. Perform a semantic hybrid search - Required Semantic Ranker enabled</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusions">💡 Conclusions</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Raouf Aliouat & Adina Stoll
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>